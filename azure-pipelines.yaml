trigger:
- main

pool:
  name: self-hosted-linux pool

steps:
# Skip code checkout since no repo content needed
- checkout: none

# Create a minimal ZIP package for deployment
- script: |
    mkdir -p $(Build.ArtifactStagingDirectory)
    echo "{}" > $(Build.ArtifactStagingDirectory)/dummy.json
    cd $(Build.ArtifactStagingDirectory)
    zip -r functionapp.zip .
  displayName: "Create minimal deployment package"

# Deploy to Linux Azure Function App
- task: AzureFunctionApp@2
  displayName: "Deploy to Azure Function App"
  inputs:
    azureSubscription: 'functionapp'           # service connection name
    appType: 'functionAppLinux'                # Linux function app
    appName: 'messagefunction-app'             # your function app name
    package: '$(Build.ArtifactStagingDirectory)/functionapp.zip'

